<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- jquery -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>

    <!-- fontawesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css" integrity="sha512-+4zCK9k+qNFUR5X+cKL9EIR+ZOhtIloNl9GIKS57V1MyNsYpYcUrUeQc9vNfzsWfV28IaLL3i96P9sdNyeRssA==" crossorigin="anonymous" />

    <!-- font -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Nanum+Gothic:wght@400;700;800&display=swap" rel="stylesheet">
    
    <!-- Swiper -->
    <link rel="stylesheet" href="https://unpkg.com/swiper@7/swiper-bundle.min.css"/>
    <script src="https://unpkg.com/swiper@7/swiper-bundle.min.js"></script>

    <!-- css, js -->
    <link rel="stylesheet" href="../assets/css/reset.css">
    <link rel="stylesheet" href="../assets/css/common.css">
    <link rel="stylesheet" href="../assets/css/profile/update.css">
</head>
<body>
<div class="body__container">
    
    <div class="section header-wrapper">
        <div class="inner">
            <div class="header">

                <div class="mr-240">
                    <a href="/image/story.html">
                        <img src="../assets/images/logo.jpg" alt="logo">
                    </a>
                </div>
        
                <div>
                    <form>
                        <button></button>
                        <input class="header__search-input" type="text" placeholder="검색">
                        <div class="search-list">

                            <div class="search-item">
                                <img src="../assets/images/insta2.jpg" alt="profile">
                                <div class="search-item__info">
                                    <span class="mb-5">dhdhshdl</span>
                                    <span>김치타</span>
                                </div>
                            </div>

                            <div class="search-item">
                                <div class="hash">#</div>
                                <div class="search-item__info">
                                    <span class="mb-5">#김치</span>
                                    <span>게시물 1,002</span>
                                </div>
                            </div>

                        </div>
                    </form>
                </div>
        
                <div>
                    <ul>
                        <li><a href="/image/story.html"><i class="fas fa-home"></i></a></li>
                        <li><a href="/chat/chat.html"><i class="fab fa-telegram-plane"></i></a></li>
                        <li><a href="#"><i class="far fa-plus-square"></i></a></li>
                        <li><a href="#"><i class="far fa-compass"></i></a></li>
                        <li class="header__notice-box-wrapper">
                            <a class="notice-heart" href="#"><i class="far fa-heart "></i></a>

                            <div class="header__notice-box">
                                <h3 class="mt-10 ml-15 fw-600">이번 주</h3>

                                <div class="notice-item">
                                    <img class="notice-item__profile" src="../assets/images/item.jpg" alt="profile">
                                    <div class="notice-item__info">
                                        <span class="fw-600">tilltofu</span>
                                        <span>님이 회원님의 사진을 좋아합니다.</span>
                                        <span>4일</span>
                                    </div>
                                    <img class="notice-item__photo" src="../assets/images/insta2.jpg" alt="photo">
                                </div>
                               
                            </div>
                        </li>
                        <li class="header__profile-picture">
                            <a href="#"><img class="header__profile-picture-img" src="../assets/images/Avatar.png" alt="profile-picture"></a>
                            <ul class="header__dropdown">
                                <div class="box-bubble"></div>
                                <li><a href="/profile/my-page.html"><i class="far fa-user-circle"></i>프로필</a></li>
                                <li><a href="/profile/my-page.html"><i class="far fa-bookmark"></i>북마크</a></li>
                                <li><a href="/profile/update.html"><i class="fas fa-cog"></i>설정</a></li>
                                <li><a href="#">로그아웃</a></li>
                            </ul>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <div class="section mt-30">
        <div class="inner">

            <div class="edit">

                <div>
                    <ul class="edit__list-div">
                        <li class="btn-edit-profile active">프로필 편집</li>
                        <li class="btn-edit-pw">비밀번호 변경</li>
                        <li class="btn-edit-push">푸쉬 알림</li>
                    </ul>
                </div>

                <div>

                    <div class="edit-profile">

                        <div class="edit-profile__profile mt-30">

                            <img src="../assets/images/Avatar.jpg" alt="profile">

                            <form id="userProfileImageForm">
                                <input type="file" class="ir_su" id="userProfileImageInput" accept="image/*"> 
                            </form>
                          
                            <div>
                                <span class="mb-5">a_a33aa</span>
                                <span class="btn-profileImageChange">프로필 사진 바꾸기</span>
                            </div>

                        </div>

                        <div class="edit-profile__info mt-20" >
                            <div class="mb-15">
                                <label for="">이름</label>
                                <input class="input--text" type="text" name="name" id="name" placeholder="이름">
                                <p>사람들이 이름, 별명 또는 비즈니스 이름 등 회원님의 알려진 이름을 사용하여 회원님의 계정을 찾을 수 있도록 도와주세요.</p>
                                <p>이름은 14일 안에 두 번만 변경할 수 있습니다.</p>
                            </div>

                            <div class="mb-15">
                                <label for="">사용자 이름</label>
                                <input class="input--text" type="text" name="username" id="username" placeholder="사용자 이름">
                                <p>대부분의 경우 14일 이내에 사용자 이름을 다시 a_a33aa(으)로 변경할 수 있습니다.</p>
                            </div>

                            <div class="mb-15">
                                <label for="">웹사이트</label>
                                <input class="input--text" type="text" name="username" id="username" placeholder="웹사이트">
                            </div>

                            <div class="mb-15">
                                <label class="mt-10" for="">소개</label>
                                <textarea class="input--text" name="" id="" cols="23" rows="5"></textarea>
                                <p>
                                    비즈니스나 반려동물 등에 사용된 계정인 경우에도 회원님의 개인정보를 입력하세요. 공개 프로필에는 포함되지 않습니다.
                                </p>
                            </div>

                            <div class="mb-15">
                                <label for="">이메일</label>
                                <input class="input--text" type="email" name="username" id="username" placeholder="이메일">
                                <button class="btn-confirm-email-check mt-15">이메일 확인</button>
                            </div>

                            <div class="mb-15">
                                <label for="">전화번호</label>
                                <input class="input--text" type="tel" name="username" id="username" placeholder="전화번호">
                            </div>

                            <div class="mb-15">
                                <label for="">성별</label>
                                <input class="input--text" type="text" name="username" id="username" placeholder="성별">
                            </div>

                            <div class="edit-profile__info__last-div mb-15">
                                <button class="btn-submit-edit-infos">제출</button>
                                <span class="btn-disable-account">계정을 일시적으로 비활성화</span>
                            </div>
                            
                        </div>

                    </div>

                    <div class="edit-pw">
                        <div class="edit-profile__profile mt-30">

                            <img src="../assets/images/Avatar.jpg" alt="profile">

                            <div>
                                <span class="mb-5" style="font-weight: bold;">a_a33aa</span>
                              
                            </div>

                        </div>

                        <div class="edit-profile__info mt-20">
                            <div class="mb-15">
                                <label for="">이전 비밀번호</label>
                                <input class="input--text" type="password" name="currentPassword" style="width: 440px; background:#fafafa;" >
                            </div>

                            <div class="mb-15">
                                <label for="">새 비밀번호</label>
                                <input class="input--text" type="password" name="newPassword1" style="width: 440px; background:#fafafa;" >
                            </div>

                            <div class="mb-15">
                                <label for="">새 비밀번호 확인</label>
                                <input class="input--text" type="password" name="newPassword2" style="width: 440px; background:#fafafa;">
                                <button class="mt-25 btn-updatePassword" style="width: 110px;">비밀번호 변경</button>

                                <p class="cursor-pointer" style="font-weight: bold;">비밀번호를 잊으셨나요?</p>
                            </div>
                            
                        </div>
                    </div>

                    <div class="edit-push">

                        <div>
                            <h3>좋아요</h3>
                            <div>
                                <input type="radio" id="" name="" value="">
                                <label for="huey">해제</label>
                            </div>

                            <div>
                                <input type="radio" id="" name="" value="" >
                                <label for="">내가 팔로우하는 사람</label>
                            </div>

                            <div>
                                <input type="radio" id="" name="" value="" checked>
                                <label for="">모든 사람</label>
                            </div>

                            <p class="mt-20">johnappleseed님이 회원님의 사진을 좋아합니다.</p>
                        </div>

                        <div>
                            <h3>댓글</h3>
                            <div>
                                <input type="radio" id="" name="" value="">
                                <label for="huey">해제</label>
                            </div>

                            <div>
                                <input type="radio" id="" name="" value="" >
                                <label for="">내가 팔로우하는 사람</label>
                            </div>

                            <div>
                                <input type="radio" id="" name="" value="" checked>
                                <label for="">모든 사람</label>
                            </div>
                            <p class="mt-20">johnappleseed님이 댓글을 남겼습니다: "멋지네요!"</p>
                        </div>

                        <div>
                            <h3>댓글 좋아요</h3>
                            <div>
                                <input type="radio" id="" name="" value="">
                                <label for="huey">해제</label>
                            </div>

                            <div>
                                <input type="radio" id="" name="" value="" >
                                <label for="">내가 팔로우하는 사람</label>
                            </div>
                            <p class="mt-20">johnappleseed님이 회원님의 댓글을 좋아합니다: "멋지네요!"</p>
                        </div>

                        <div>
                            <h3>회원님이 나온 사진의 좋아요 및 댓글</h3>
                            <div>
                                <input type="radio" id="" name="" value="">
                                <label for="huey">해제</label>
                            </div>

                            <div>
                                <input type="radio" id="" name="" value="" >
                                <label for="">내가 팔로우하는 사람</label>
                            </div>

                            <div>
                                <input type="radio" id="" name="" value="" checked>
                                <label for="">모든 사람</label>
                            </div>
                            <p class="mt-20">johnappleseed님이 회원님이 태그된 게시물에 댓글을 남겼습니다.</p>
                        </div>

                        <div>
                            <h3>수락한 팔로우 요청</h3>
                            <div>
                                <input type="radio" id="" name="" value="">
                                <label for="huey">해제</label>
                            </div>

                            <div>
                                <input type="radio" id="" name="" value="" checked>
                                <label for="">모든 사람</label>
                            </div>
                            <p class="mt-20">John Appleseed(@johnappleseed)님이 팔로우 요청을 수락했습니다.</p>
                        </div>

                        <div>
                            <h3>Instagram Direct</h3>
                            <div>
                                <input type="radio" id="" name="" value="">
                                <label for="huey">해제</label>
                            </div>

                            <div>
                                <input type="radio" id="" name="" value="" checked>
                                <label for="">모든 사람</label>
                            </div>
                            <p class="mt-20">johnappleseed님이 메시지를 보냈습니다.</p>
                        </div>

                        <div>
                            <h3>동영상 조회수</h3>
                            <div>
                                <input type="radio" id="" name="" value="">
                                <label for="huey">해제</label>
                            </div>

                            <div>
                                <input type="radio" id="" name="" value="" checked>
                                <label for="">모든 사람</label>
                            </div>
                            <p class="mt-20">회원님의 동영상 조회수가 10만회를 넘었습니다.</p>
                        </div>

                        <div>
                            <h3>라이브 방송</h3>
                            <div>
                                <input type="radio" id="" name="" value="">
                                <label for="huey">해제</label>
                            </div>

                            <div>
                                <input type="radio" id="" name="" value="" checked>
                                <label for="">모든 사람</label>
                            </div>
                            <p class="mt-20">johnappleseed님이 라이브 방송을 시작했습니다. 지금 바로 시청해보세요!</p>
                        </div>

                    </div>

                </div>

            </div>
        </div>
    </div>

</div>

<div class="modal-wrapper modal-disable-acount-wrapper">
    <div class="modal modal-disable-acount">
        <img class="mt-40 mb-25" src="../assets/images/item.jpg" alt="profile">

        <p class="mb-30">@blahdi_jk 계정을 비활성화 하시겠습니까?</p>

        <button class="btn-disable-account-run">계정 비활성화</button>
        <button class="btn-cancel-disable-account">취소</button>
    </div>
</div>
<script>
    // 프로파일 사진 변경 버튼
    $(".btn-profileImageChange").on("click", function(e){

        // 페이지 유저와 로그인 유저가 다를 경우
        // if(pageUserId != principalId){
        //     alert("프로필 사진을 수정할 수 없는 유저입니다.");
        //     return;
        // }
        
        // input type="file" 클릭 이벤트
        $("#userProfileImageInput").click();
        
        // 유저가 프로필 이미지를 변경했을때 감지해서 동작
        $("#userProfileImageInput").on("change", (e) => {
            let f = e.target.files[0];
            
            // 이미지 파일이 아닐 경우
            if (!f.type.match("image.*")) {
                alert("이미지를 등록해야 합니다.");
                return;
            }
            
            //서버에 이미지를 전송
            let profileImageForm = $("#userProfileImageForm")[0]; // foam 태그의 id인데 배열로 받아와야 한다.
            
            // formData 객체를 이용하면 form 태그의 필드와 그 값을 나타내는 일련의 key/value 쌍을 담을 수 있다.
            let formData = new FormData(profileImageForm); // form 태그 안의 데이터가 담긴다. 여기선 이미지가 담김
            
            $.ajax({
                
                type: "put",
                url: `/api/user/${principalId}/profileImageUrl`,
                data: formData,
                contentType: false,  // ajax로 사진 전송시 필수, x-www-form-urlencoded로 파싱되는 것을 방지
                processData: false, // ajax로 사진 전송시 필수, contentType을 false로 줬을 때 QueryString 자동 설정됨, 그것을 해제
                enctype: "multipart-form-data", // form 태그에 entype 타입 기입시 안적어줘도 되는데 가독성 때문에 둘다 해주는게 좋을듯
                dataType: "json"
                
            }).done(res => {
                
                // 사진 전송 성공시 이미지 변경
                let reader = new FileReader();
                reader.onload = (e) => {
                    $("#userProfileImage").attr("src", e.target.result);
                }
                reader.readAsDataURL(f); // 이 코드 실행시 reader.onload 실행됨.
                
            }).fail(error => {
                console.log("사진 변경 오류", error);
                alert("사진 변경이 실패되었습니다");
            });
        
        });
    })

    // btn 계정 비활성화 모달 켜기
    $(".btn-disable-account").on("click", function(){
        $(".modal-disable-acount-wrapper").css("display", "flex");
    })

    // btn 계정 비활성화 모달 끄기
    $(".btn-cancel-disable-account").on("click", function(e){
        e.preventDefault();
        $(".modal-disable-acount-wrapper").hide();
    })

    // btn 계정 비활성화 API
    $(".btn-disable-account-run").on("click", function(e){
        alert("계정 비활성화 API 로직");
        $(".modal-disable-acount-wrapper").hide();
    })

    // btn 제출
    $(".btn-submit-edit-infos").on("click", function(e){
        alert("유효성 검사, 프로필 편집 API")
    })

    // btn 이메일 확인
    $(".btn-confirm-email-check").on("click", function(e){
        alert("이메일 확인 API");
    })

    // btn 비밀번호 변경
    $(".btn-updatePassword").on("click", function(e){
        e.preventDefault();

        if($("input[name='currentPassword']").val() == ""){
           alert("이전 비밀번호를 입력해주세요");
           $("input[name='currentPassword']").focus();
           return;
        }

        if($("input[name='newPassword1']").val() == ""){
           alert("새 비밀번호를 입력해주세요");
           $("input-signup [name='newPassword1']").focus();
           return;
        }

        if($("input[name='newPassword2']").val() == ""){
           alert("새 비밀번호 확인을 입력해주세요");
           $("input[name='newPassword2']").focus();
           return;
        }

        if($("input[name='newPassword1']").val() != $("input[name='newPassword2']").val()){
           alert("새 비밀번호가 일치하지 않습니다. 다시 한번 확인해주세요");
           $("input[name='newPassword1']").focus();
           return;
        }

        alert("api 호출");

    })
</script>
<script src="../assets/js/common.js"></script>
<script src="../assets/js/profile/update.js"></script>
</body>
</html>